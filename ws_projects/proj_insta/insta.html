<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>insta burrito</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
    <h1>Insta Inspo </h1>
    <h3>Some Info: <span id="someInfo"></span></h3>

    <input type="text" id="handleText" name="handleText" placeholder="Input insta handle here">
    <input type="button" id="btnSubmit" name="btnSubmit" value="Let's geddit!">

    <h3>Here's an image!<br></h3>
    <img id="result_img_1" crossorigin="anonymous" src="">
    <h3>Caption: <br><span id="caption_text"></span></h3>



    <script>
        //Add event listener to button


        //Add Async function
        async function fetchInstaPost() {
            console.log("fetching inst ")
            const options = {
                method: 'GET',
                url: 'https://instagram-scraper-api2.p.rapidapi.com/v1.2/posts',
                params: {
                    username_or_id_or_url: 'nasa'
                },
                headers: {
                    'x-rapidapi-key': '609e2558d1msh6b1c444f29b8f22p1360fejsn858e524c731d',
                    'x-rapidapi-host': 'instagram-scraper-api2.p.rapidapi.com'
                }
            };

            try {
                const response = await axios.request(options);
                //console.log("getting inst info")
                //console.log(response.data.data);
                //console.log(`image  + ${response.data.data.items[0].thumbnail_url}`)
                let thumbnail_url = response.data.data.items[0].thumbnail_url;
                document.getElementById('igframe').src = thumbnail_url;
                let caption = response.data.data.items[0].caption.text;
                console.log(caption);

                let img_url = response.data.data.items[0].thumbnail_url;
                console.log(img_url);


                document.getElementById("caption_text").innerHTML = caption;

            } catch (error) {
                console.error(error);
            }
        }

        // // add Async function to download photos
        // async function downloadImage(imageUrl) {
        //     try {
        //         // Step 1: Fetch the image asynchronously
        //         const response = await fetch(imageUrl, { mode: 'cors' });

        //         // If the response isn't OK, throw an error
        //         if (!response.ok) throw new Error('Network response was not ok');

        //         // Step 2: Convert the response to a Blob asynchronously
        //         const blob = await response.blob();

        //         // Step 3: Create a download link for the Blob
        //         const blobUrl = URL.createObjectURL(blob);
        //         const link = document.createElement('a');
        //         link.href = blobUrl;
        //         link.download = 'downloaded_image.jpg';

        //         // Step 4: Trigger the download
        //         document.body.appendChild(link);
        //         link.click();
        //         document.body.removeChild(link);

        //         // Step 5: Clean up the Blob URL
        //         URL.revokeObjectURL(blobUrl);

        //         console.log('Image downloaded successfully!');
        //     } catch (error) {
        //         console.error('Error downloading the image:', error);
        //     }
        // }



        //Call Async function 
        fetchInstaPost()
        // downloadImage();
    </script>

</body>

</html>